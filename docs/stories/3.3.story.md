# Story 3.3: Mentee Profile â€” Records & Notes

**Epic:** 3 â€” Mentor Dashboard & Mentee Management
**Status:** Draft
**Priority:** High
**Story Type:** Frontend + API

---

## Executor Assignment

executor: "@dev"
quality_gate: "@architect"
quality_gate_tools: ["architecture-review", "code-standards"]

---

## Story Statement

> As a mentor,
> I want to view a mentee's complete record timeline and add my own notes,
> so that I can prepare for mentoring sessions.

---

## Acceptance Criteria

- [ ] **AC1:** Rota `/dashboard/mentees/{id}` com perfil completo do mentorado
- [ ] **AC2:** Header: nome, data de inÃ­cio na mentoria, streak atual, total de registros
- [ ] **AC3:** Aba "Registros": timeline completa dos registros (o mentor pode abrir cada um e ler situaÃ§Ã£o, reaÃ§Ã£o, perguntas IA, respostas)
- [ ] **AC4:** Aba com conteÃºdo placeholder para: EvoluÃ§Ã£o, RelatÃ³rios, PadrÃµes IA (implementados no Epic 4)
- [ ] **AC5:** Bloco de Notas do Mentor: campo de texto persistente (rich text bÃ¡sico ou textarea) onde Rafael anota observaÃ§Ãµes â€” autosave
- [ ] **AC6:** API Routes: `GET /api/dashboard/mentees/{id}`, `GET /api/dashboard/mentees/{id}/entries`, `PUT /api/mentor-notes/{menteeId}`
- [ ] **AC7:** RLS garante que apenas o mentor acessa esses dados
- [ ] **AC8:** Loading e error states adequados

---

## Dev Notes

### Page Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Mentorados   JoÃ£o Silva                       â”‚
â”‚  Desde: 15 jan 2026 Â· ðŸ”¥ 12 dias Â· 45 registros  â”‚
â”‚                                                  â”‚
â”‚  [Registros] [EvoluÃ§Ã£o] [RelatÃ³rios] [PadrÃµes IA]â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                  â”‚
â”‚  Timeline de Registros                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 27 fev Â· AudiÃªncia Â· Ansiedade Â· 8       â”‚   â”‚
â”‚  â”‚ SituaÃ§Ã£o: "AudiÃªncia tensa com juiz..."   â”‚   â”‚
â”‚  â”‚ ReaÃ§Ã£o: "Tentei manter a calma..."        â”‚   â”‚
â”‚  â”‚ IA: "Quando vocÃª percebeu que..."         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  Notas do Mentor                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Minhas observaÃ§Ãµes sobre este mentorado...â”‚   â”‚
â”‚  â”‚ (autosave)                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API Endpoints
[Source: docs/architecture.md#api-specification]
- `GET /api/dashboard/mentees/[id]` â€” mentee profile (name, created_at, streak, total entries)
- `GET /api/dashboard/mentees/[id]/entries` â€” mentee's entries with reflections (paginated)
- `GET /api/mentor-notes/[menteeId]` â€” fetch mentor's notes for this mentee
- `PUT /api/mentor-notes/[menteeId]` â€” update notes (autosave, upsert)

### Component Specs
[Source: docs/architecture.md#components]
- Mentee Management: `MenteeProfile`, `TabRecords`, `TabEvolution` (placeholder), `TabReports` (placeholder), `TabPatterns` (placeholder), `MentorNotepad`
- MentorNotepad: textarea with debounced autosave (500ms debounce)

### Mentor Notes Data Model
[Source: docs/architecture.md#data-models]
```typescript
interface MentorNote {
  id: string;
  mentor_id: string;
  mentee_id: string;
  content: string;
  created_at: string;
  updated_at: string;
}
```
- UNIQUE(mentor_id, mentee_id) â€” one note document per mentee
- Upsert pattern: insert or update on conflict

### File Locations
- Page: `packages/web/src/app/(mentor)/dashboard/mentees/[id]/page.tsx`
- API Routes: `packages/web/src/app/api/dashboard/mentees/[id]/route.ts`, `.../[id]/entries/route.ts`
- Mentor Notes API: `packages/web/src/app/api/mentor-notes/[menteeId]/route.ts`
- Components: `packages/web/src/components/dashboard/` â€” MenteeProfile.tsx, TabRecords.tsx, MentorNotepad.tsx
- DB: `packages/web/src/lib/db/mentor-notes.ts`

---

## Tasks / Subtasks

- [ ] **Task 1** (AC: 6): Create API Route `GET /api/dashboard/mentees/[id]` â€” return mentee profile data (name, created_at, streak, total entries)
- [ ] **Task 2** (AC: 6): Create API Route `GET /api/dashboard/mentees/[id]/entries` â€” return mentee's entries with joined ai_reflections, paginated
- [ ] **Task 3** (AC: 6): Create API Routes for mentor notes â€” `GET` and `PUT /api/mentor-notes/[menteeId]` with upsert logic
- [ ] **Task 4** (AC: 1, 2): Create mentee profile page â€” header with name, join date, streak, total entries
- [ ] **Task 5** (AC: 3): Create `TabRecords` â€” timeline of entries, each expandable to show full details (situation, reaction, self_perception, AI questions/answers)
- [ ] **Task 6** (AC: 4): Create placeholder tabs for EvoluÃ§Ã£o, RelatÃ³rios, PadrÃµes IA â€” "Em breve" message
- [ ] **Task 7** (AC: 5): Create `MentorNotepad` â€” textarea with debounced autosave (PUT request on 500ms debounce after typing stops)
- [ ] **Task 8** (AC: 7): Verify RLS policies work correctly â€” only mentor role can access these endpoints
- [ ] **Task 9** (AC: 8): Add loading skeletons and error states for profile, entries, and notes
- [ ] **Task 10**: Write unit tests for MentorNotepad autosave, profile components

---

## CodeRabbit Integration

> **CodeRabbit Integration**: Disabled

---

## File List

_To be updated during implementation._

---

## Dev Agent Record

_To be filled by @dev during implementation._

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-27 | 1.0 | Story drafted | @sm |

---

## QA Results

_To be filled by @qa during review._
